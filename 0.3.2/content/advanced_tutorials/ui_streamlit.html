

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Service with Graphical User Interface &mdash; Multiviz Integrator  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Going Beyond the SDK" href="going_beyond_sdk.html" />
    <link rel="prev" title="Connecting MVI with Other Tools" href="integration_with_other_tools.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/VA_Symbol_DarkBlue.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/mvi_description.html">MultiViz Integrator</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/first_service.html">Deploying Your First Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/custom_service.html">Creating Your Own service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/autodocs.html">API Autodocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/shadow_deployment.html">Versioning and Shadow Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/reaching_service_from_external_applications.html">Reaching a service from external applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/ticker.html">Schedule Repeating Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/monitoring.html">Monitoring Your Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/cross_service_communication.html">Cross-service Communication</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="deploying_ml_model.html">Deploying Machine Learning Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk_typing.html">Typing in the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_multiple_hosts.html">Using Multiple Hosts</a></li>
<li class="toctree-l1"><a class="reference internal" href="email_notifications.html">Email Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_deploy.html">Deployment Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_autocompletion.html">Autocompletion</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager_https.html">Secure Manager Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager_env_vars.html">Manager Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy_dashboard.html">Proxy Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration_with_other_tools.html">Connecting MVI with Other Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Service with Graphical User Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-the-streamlit-service">Creating the Streamlit Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploying-the-service">Deploying the Service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="going_beyond_sdk.html">Going Beyond the SDK</a></li>
</ul>
<p class="caption"><span class="caption-text">Api Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/cli.html">Command-line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/sdk.html">Software Development Kit</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Multiviz Integrator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Service with Graphical User Interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/content/advanced_tutorials/ui_streamlit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="service-with-graphical-user-interface">
<span id="streamlit-service-reference"></span><h1>Service with Graphical User Interface<a class="headerlink" href="#service-with-graphical-user-interface" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will see how to create a service with a graphical interface
using a very convenient python package called <a class="reference external" href="https://www.streamlit.io/">streamlit</a>.</p>
<p>With streamlit it is very quick to make graphical applications and this can be
used together with MVI to make dashboards for monitoring or configuration of
your algorithms, just to name a few examples. We will not go into detail into how
to use streamlit itself, but rather how to deploy a streamlit application in MVI and
have it communicate with your services.</p>
<div class="section" id="creating-the-streamlit-service">
<h2>Creating the Streamlit Service<a class="headerlink" href="#creating-the-streamlit-service" title="Permalink to this headline">¶</a></h2>
<p>Let’s reuse the <cite>Die Roller</cite> service we created as part of the <cite>Yatzee</cite> game in
<a class="reference internal" href="../getting_started/cross_service_communication.html#cross-service-reference"><span class="std std-ref">Cross-service Communication</span></a> and create a roll button and a display for the
die roll. We start by creating a new project:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mvi</span> <span class="n">init</span>
<span class="go">Active host: http://your-host</span>
<span class="go">project_name [my_project]: die_app</span>
</pre></div>
</div>
<p>The first thing we have to do is to add <code class="docutils literal notranslate"><span class="pre">streamlit</span></code> to the <cite>requirements.txt</cite>
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">va</span><span class="o">-</span><span class="n">mvi</span>
<span class="n">streamlit</span>
</pre></div>
</div>
<p>We also rename <cite>service.py</cite> to <cite>die_app.py</cite>. This is where we will write our
streamlit app, but in order for it to run when we start the service, we have to
create a new file called <cite>app.sh</cite> with the contents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">streamlit</span> <span class="n">run</span> <span class="n">die_app</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">streamlit</span> <span class="pre">run</span> <span class="pre">script.py</span></code> is the command that is used to start a streamlit app,
and we have to make MVI run that command when it starts the service. Normally MVI
runs <cite>service.py</cite> but this can be changed by modifying <code class="docutils literal notranslate"><span class="pre">APP_SCIPT</span></code> in
<cite>.s2i/environment</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">APP_SCRIPT</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>This way we tell MVI that <cite>app.sh</cite> is the main file of the service and that it should
be run on startup. Now that all the boring stuff is out of the way, we can start
writing the app in <cite>die_app.py</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">from</span> <span class="nn">mvi.mvi</span> <span class="kn">import</span> <span class="n">call_service</span>

<span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Die App&quot;</span><span class="p">)</span>

<span class="n">roll</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Roll&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">roll</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">call_service</span><span class="p">(</span>
        <span class="n">service_name</span><span class="o">=</span><span class="s2">&quot;die_roller&quot;</span><span class="p">,</span>
        <span class="n">entrypoint_name</span><span class="o">=</span><span class="s2">&quot;roll_die&quot;</span>
    <span class="p">)</span>


    <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Roll:&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="deploying-the-service">
<h2>Deploying the Service<a class="headerlink" href="#deploying-the-service" title="Permalink to this headline">¶</a></h2>
<p>Since <cite>die_app</cite> is dependent of <cite>die_roller_service</cite> it has to be up and running
before <cite>die_app</cite> can be used. The code for <cite>die_roller_service</cite> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">mvi.mvi</span> <span class="kn">import</span> <span class="n">MviService</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="n">mvi</span> <span class="o">=</span> <span class="n">MviService</span><span class="p">()</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@mvi</span><span class="o">.</span><span class="n">entrypoint</span>
<span class="k">def</span> <span class="nf">roll_die</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>


<span class="n">mvi</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mvi</span> <span class="n">deploy</span> <span class="n">die_roller</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span> <span class="o">./</span><span class="n">die_roller_service</span>
<span class="go">Active host: http://your-host</span>
<span class="go">Deploying service...</span>
<span class="go">Service deployed successfully</span>
<span class="go">MAIN    NAME         VERSION    STATUS    RUNNING</span>
<span class="go">------  -----------  ---------  --------  -----------------------------------</span>
<span class="go">*       die_roller   1.0.0      running   Running (since 2020-12-15 12:10:25)</span>
</pre></div>
</div>
<p>We can now deploy the streamlit app, like we would any other, with one important
difference. Streamlit uses internal port 8501 to communicate so we have to explicitly
set the port when deploying:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mvi</span> <span class="n">deploy</span> <span class="n">die_app</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span> <span class="o">./</span><span class="n">die_app</span> <span class="o">--</span><span class="n">port</span> <span class="mi">8501</span>
<span class="go">Active host: http://your-host</span>
<span class="go">Deploying service...</span>
<span class="go">Service deployed successfully</span>
<span class="go">MAIN    NAME     VERSION    STATUS    RUNNING</span>
<span class="go">------  -------  ---------  --------  -----------------------------------</span>
<span class="go">*       die_app  1.0.0      running   Running (since 2020-12-15 12:15:35)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MVI services created using the SDK use port 8000, which is the default
port for <code class="docutils literal notranslate"><span class="pre">mvi</span> <span class="pre">deploy</span></code>. But when deploying other apps it might be necessary
to change it to not get a <cite>Bad Gateway</cite>.</p>
</div>
<p>Open <a class="reference external" href="http://your-host/services/die_app/">http://your-host/services/die_app/</a> and you should see your app there:</p>
<a class="reference internal image-reference" href="../../_images/streamlit_service.png"><img alt="Screenshot of streamlit service" src="../../_images/streamlit_service.png" style="width: 200px;" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="going_beyond_sdk.html" class="btn btn-neutral float-right" title="Going Beyond the SDK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="integration_with_other_tools.html" class="btn btn-neutral float-left" title="Connecting MVI with Other Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Viking Analytics AB.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: 0.3.2
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../../0.1.0/index.html">0.1.0</a></dd>
      <dd><a href="../../../0.1.0.dev1/index.html">0.1.0.dev1</a></dd>
      <dd><a href="../../../0.1.0.dev2/index.html">0.1.0.dev2</a></dd>
      <dd><a href="../../../0.1.0.dev3/index.html">0.1.0.dev3</a></dd>
      <dd><a href="../../../0.1.0.dev4/index.html">0.1.0.dev4</a></dd>
      <dd><a href="../../../0.1.0.dev5/index.html">0.1.0.dev5</a></dd>
      <dd><a href="../../../0.1.1/index.html">0.1.1</a></dd>
      <dd><a href="../../../0.2.0/index.html">0.2.0</a></dd>
      <dd><a href="../../../0.3.0/content/advanced_tutorials/ui_streamlit.html">0.3.0</a></dd>
      <dd><a href="../../../0.3.0.dev1/index.html">0.3.0.dev1</a></dd>
      <dd><a href="../../../0.3.0.dev2/index.html">0.3.0.dev2</a></dd>
      <dd><a href="../../../0.3.1/content/advanced_tutorials/ui_streamlit.html">0.3.1</a></dd>
      <dd><a href="ui_streamlit.html">0.3.2</a></dd>
      <dd><a href="../../../0.3.3/content/advanced_tutorials/ui_streamlit.html">0.3.3</a></dd>
      <dd><a href="../../../0.3.4/content/advanced_tutorials/ui_streamlit.html">0.3.4</a></dd>
      <dd><a href="../../../0.4.0/content/advanced_tutorials/ui_streamlit.html">0.4.0</a></dd>
      <dd><a href="../../../0.4.1/content/advanced_tutorials/ui_streamlit.html">0.4.1</a></dd>
      <dd><a href="../../../0.4.2/index.html">0.4.2</a></dd>
      <dd><a href="../../../0.4.3/index.html">0.4.3</a></dd>
      <dd><a href="../../../0.4.4/index.html">0.4.4</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../../develop/index.html">develop</a></dd>
    </dl>
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>