

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>CLI Deployment Options &mdash; Multiviz Integrator  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Autocompletion" href="cli_autocompletion.html" />
    <link rel="prev" title="Email Notifications" href="email_notifications.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/VA_Symbol_DarkBlue.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/mvi_description.html">MultiViz Integrator</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/first_service.html">Deploying Your First Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/custom_service.html">Creating Your Own service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/autodocs.html">API Autodocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/shadow_deployment.html">Versioning and Shadow Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/reaching_service_from_external_applications.html">Reaching a service from external applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/ticker.html">Schedule Repeating Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/monitoring.html">Monitoring Your Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/cross_service_communication.html">Cross-service Communication</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="deploying_ml_model.html">Deploying Machine Learning Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk_typing.html">Typing in the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_multiple_hosts.html">Using Multiple Hosts</a></li>
<li class="toctree-l1"><a class="reference internal" href="email_notifications.html">Email Notifications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CLI Deployment Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="#advanced-deployment-of-docker-images">Advanced Deployment of Docker Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_autocompletion.html">Autocompletion</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing_services.html">Testing Services Before Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager_configuration.html">Manager Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing_services.html">Testing Services Before Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy_dashboard.html">Proxy Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration_with_other_tools.html">Connecting MVI with Other Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui_streamlit.html">Using Streamlit to build a dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui_plotly_dash.html">Using Plotly Dash to build a dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="going_beyond_sdk.html">Going Beyond the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="upload_image.html">Upload local docker image</a></li>
</ul>
<p class="caption"><span class="caption-text">Api Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/cli.html">Command-line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/sdk.html">Software Development Kit</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Multiviz Integrator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>CLI Deployment Options</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/content/advanced_tutorials/cli_deploy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cli-deployment-options">
<span id="cli-deploy-reference"></span><h1>CLI Deployment Options<a class="headerlink" href="#cli-deployment-options" title="Permalink to this headline">¶</a></h1>
<p>There are a few ways to use the <code class="docutils literal notranslate"><span class="pre">deploy</span></code> command from the <a class="reference internal" href="../api_reference/cli.html#cli-reference"><span class="std std-ref">Command-line Interface</span></a>
that we haven’t looked at until this point. In this tutorial we will look at
those, to make sure you have a good idea of the options you have available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Always remember the <code class="docutils literal notranslate"><span class="pre">--help</span></code> option. It can be used with each command as well
as the whole <code class="docutils literal notranslate"><span class="pre">mvi</span></code> command-line app to get a description of what options you
have. If you are unsure how and what-for a certain command is used, it should
be your go-to option.</p>
</div>
<p>So far, we have only deployed services from project directories, but there are
a few more options. First of all, it is possible to deploy a service from a tarball
(.tar.gz file), which is actually what is been happening behind the scenes.</p>
<p>There’s also two options for deployment source: <code class="docutils literal notranslate"><span class="pre">--git</span></code> which deploys a
service given a git repository with the same contents as the services we
have deployed so far. It is functionally identical to deploying from a
local directory. For now, it only supports public git repositories:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mvi</span> <span class="n">deploy</span> <span class="o">--</span><span class="n">git</span> <span class="n">my_service</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">sclorg</span><span class="o">/</span><span class="n">django</span><span class="o">-</span><span class="n">ex</span> 
<span class="go">Active host: http://your-host</span>
<span class="go">Deploying service...</span>
<span class="go">Service deployed successfully</span>
<span class="go">MAIN    NAME        VERSION    STATUS    RUNNING</span>
<span class="go">------  ----------  ---------  --------  -----------------------------------</span>
<span class="go">*       my_service  1.0.0      running   Running (since 2020-11-23 16:56:06)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--image</span></code> option can be used to deploy any docker image as an MVI service.
This can be useful for deploying applications that are not written using the
SDK within the MVI framework. Similar to the <code class="docutils literal notranslate"><span class="pre">--git</span></code> option it only supports
public images for now. Keep in mind that most pre-build images will not
support the automatic interactive documentation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mvi</span> <span class="n">deploy</span> <span class="o">--</span><span class="n">image</span> <span class="n">my_service2</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span> <span class="n">traefik</span><span class="o">/</span><span class="n">whoami</span> <span class="o">--</span><span class="n">port</span> <span class="mi">80</span> 
<span class="go">Active host: http://your-host</span>
<span class="go">Deploying service...</span>
<span class="go">Service deployed successfully</span>
<span class="go">MAIN    NAME         VERSION    STATUS    RUNNING</span>
<span class="go">------  -----------  ---------  --------  -----------------------------------</span>
<span class="go">*       my_service2  1.0.0      running   Running (since 2020-11-23 16:57:55)</span>
</pre></div>
</div>
<p>In the last command we used an optional argument to change the internal port of
the service container. This is not required when deploying services locally or
from git repositories, but it might be necessary when deploying from an image.</p>
<p>Each of these options can also be used with only their first letter:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Long Option</p></th>
<th class="head"><p>Short option</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>–git</p></td>
<td><p>-g</p></td>
</tr>
<tr class="row-odd"><td><p>–image</p></td>
<td><p>-i</p></td>
</tr>
<tr class="row-even"><td><p>–port</p></td>
<td><p>-p</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="advanced-deployment-of-docker-images">
<h1>Advanced Deployment of Docker Images<a class="headerlink" href="#advanced-deployment-of-docker-images" title="Permalink to this headline">¶</a></h1>
<p>Extra <code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code> arguments (beyond port number and environment variables) needed for the docker image
to run properly can be specified when deploying the image via the <code class="docutils literal notranslate"><span class="pre">/~image</span></code> POST HTTP endpoint. These extra
<code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code> arguments should be specified under the <code class="docutils literal notranslate"><span class="pre">docker_run_args</span></code> key in the request data field. The accepted
parameters for docker run which can be found <a class="reference external" href="https://docker-py.readthedocs.io/en/stable/containers.html">here</a>.</p>
<p>For instance, a docker image
that requires <code class="docutils literal notranslate"><span class="pre">privileged</span></code> mode to run properly can be deployed like (using pythons request library):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://&lt;host&gt;/~image,</span>
    <span class="n">headers</span><span class="o">=&lt;</span><span class="n">headers</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;image&#39;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">image</span><span class="o">&gt;</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s1">&#39;port&#39;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s1">&#39;docker_run_args&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;privileged&#39;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="o">...</span>
        <span class="p">}</span>
    <span class="p">})</span>
</pre></div>
</div>
<p>The interactive docs at <code class="docutils literal notranslate"><span class="pre">&lt;host&gt;/docs</span></code> is also very useful for this kind of deployment.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cli_autocompletion.html" class="btn btn-neutral float-right" title="Autocompletion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="email_notifications.html" class="btn btn-neutral float-left" title="Email Notifications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Viking Analytics AB.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>